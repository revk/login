menu "Database"

    config DB_CONF
    	string "Database access config file"
	default ""
	help
		Specify the path of the mysql.conf file for database access

    config DB_FROM_ENV
    	bool "Expect database name in environment"
	default n
	help
		If database name is expected from an environment variable

    config DB_DATABASE
    	string "Database name"
	default ""
	depends on !DB_FROM_ENV
	help
		Fixed database name to use (may be in mysql.conf if not set here)

    config DB_USER_TABLE
    	string "User table"
	default "user"
	help
		Table for user ID and password

    config DB_USER_FIELD
    	string "User login field"
	default "user"
	help
		The field name in user table for the user login name/email/etc

    config DB_PASS_FIELD
    	string "User password field"
	default "pass"
	help
		The field name in user table for the password hash

    config DB_LAST_LOGIN_FIELD
    	string "User lastlogin field"
	default ""
	help
		The field name in user table for the last time logged in

    config DB_SEPARATE_SESSION
    	bool "Separate session table"
	default y
	help
		If a separate session table is to be used

    config DB_SESSION_TABLE
    	string "Session table"
	default "session"
	depends on DB_SEPARATE_SESSION
	help
		Table for session tracking

    config DB_SESSION_FIELD
    	string "Session cookie field"
	default "session"
	help
		Field name for session tracking cookie

    config DB_SESSION_USER_LINK
    	string "Field name in session table to link to user"
	default "user"
	depends on DB_SEPARATE_SESSION
	help
		Field name, probably foreign key, from session table to user

    config DB_USER_KEY_FIELD
    	string "Field name in user table that is primary key linked from session table"
	default "ID"
	depends on DB_SEPARATE_SESSION
	help
		Field name of primary key in user table linked from session table

    config DB_SESSION_TIME
    	string "Field name in session table for logged in time"
	default "logintime"
	depends on DB_SEPARATE_SESSION
	help
		Field name for logged in time

    config DB_SESSION_IP
    	string "Field name in session table for logged in IP"
	default "IP"
	depends on DB_SEPARATE_SESSION
	help
		Field name for logged in IP address varchar(39) - updated if it changes...

endmenu

menu "CGI Wrapper"

    config SESSION_COOKIE
	string "Session cookie"
	default "ENVCGI"
	help
		Name of session cookie

    config SESSION_EXPIRY
    	int "Session expiry (hours)"
	default 24
	help
		Session expiry (hours), set 0 for unlimited

    config PAGE_LOGIN
	string "Login"
	default "/login.cgi"
	help
		Login page to which user is redirected

    config ENV_DB_FROM_URL
    	bool "Set database environment variable from first part of URL"
	default n
	depends on DB_FROM_ENV
	help
		Sets the database environment variable based on the first part of url, e.g. https://example.com/from/stuff.cgi sets to from
endmenu

menu "Environment"

    config ENV_DB
    	string "Database environment variable"
	default ""
	depends on DB_FROM_ENV
	help
		Name of database environment variable

    config ENV_SESSION
	string "Session environment variable"
	default "ENVCGI"
	help
		Name of session environment variable

    config ENV_BACK
	string "Back link environment variable"
	default "BACK"
	help
		Environment variable included when redirecting to login page to allow return to requested page (if was a GET)

endmenu

menu "Passwords"

    config PASSWORD_MIN
    	int "Min password length"
	default 8
	help
		Default minimum password length

    config PASSWORD_MAX
    	int "Max password length"
	default 32
	help
		Default maximum password length

    config PASSWORD_ENTROPY
    	int "Min password entropy"
	default 40
	help
		Default minimum password entropy

    config PASSWORD_UPDATE
    	bool "Update to latest hash on login"
	default y
	help
		Update hash to latest hash on successful login

    config PASSWORD_ARGON2
    	bool "Accept Argon2 hash"
	default y
	help
		Accept Argon2 hashes

    config PASSWORD_SHA256
    	bool "Accept SHA256 hash"
	default y
	help
		Accept SHA256 hashes

    config PASSWORD_SHA1
    	bool "Accept SHA1 hash"
	default y
	help
		Accept SHA1 hashes

    config PASSWORD_MD5
    	bool "Accept MD5 hash"
	default y
	help
		Accept MD5 hashes

    config PASSWORD_MYSQL
    	bool "Accept mysql hash"
	default y
	help
		Accept mysql hashes

    config PASSWORD_OLDMYSQL
    	bool "Accept very old mysql hash"
	default n
	help
		Accept the very insure very old mysql password hashes

endmenu

